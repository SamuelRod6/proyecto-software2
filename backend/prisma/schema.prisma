generator client {
  provider = "prisma-client-go"
  output   = "./db"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id_usuario    Int      @id @default(autoincrement())
  nombre        String   @unique
  email         String   @unique
  password_hash String
  id_rol        Int
  rol           Roles    @relation(fields: [id_rol], references: [id_rol])
  createdAt     DateTime @default(now())
  inscripciones Inscripcion[]
}

model Roles {
  id_rol      Int       @id @default(autoincrement())
  nombre_rol  String    @unique
  descripcion String
  createdAt   DateTime  @default(now())
  Usuario     Usuario[]
}

model Evento {
  id_evento                  Int      @id @default(autoincrement())
  nombre                     String   @unique
  fecha_inicio               DateTime
  fecha_fin                  DateTime
  fecha_cierre_inscripcion   DateTime
  inscripciones_abiertas_manual Boolean @default(true)
  ubicacion                  String
  createdAt                  DateTime @default(now())
  inscripciones              Inscripcion[]
}

model Inscripcion {
  id_inscripcion Int      @id @default(autoincrement())
  fecha          DateTime @default(now())
  estado_pago    Boolean  @default(false)
  comprobante    String   @default("")
  id_evento      Int
  id_usuario     Int
  evento         Evento   @relation(fields: [id_evento], references: [id_evento])
  usuario        Usuario  @relation(fields: [id_usuario], references: [id_usuario])

  @@unique([id_evento, id_usuario])
}
